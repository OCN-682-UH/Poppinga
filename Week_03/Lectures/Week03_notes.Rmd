---
title: "Week 03 Notes"
author: "Haley Poppinga"
date: "2025-09-09"
output: github_document
---

## Introduction to Plotting and Plotting 2

Load libraries 
```{r}
library(tidyverse)
library(here)
library(ggplot2)
library(palmerpenguins)
```

Read in data
The data is part of the package and is called penguins

```{r}
glimpse(penguins)
```

Making plots for second lecture found after ggplot resources

.green[ggplot2] is a data visualization package  

Structure of the plot can be summarized like this:
  
ggplot(data = [dataset], 
       mapping = aes(x = [x-variable], 
                     y = [y-variable])) +
    geom_xxx() +

Other options:
aes() means aesthetics 
geom_xx means geometry
  

Data: Palmer Penguins
Measurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex.  

Set-up your script and don't forget to comment. _See script file_

### We will make this plot:
```{r}
ggplot(data=penguins, #should be comma in between every function
       mapping = aes(x = bill_depth_mm,  #map bill depth to the x-axis 
                     y = bill_length_mm, #map bill length to the y-axis
      geom_point() +                     #Represent each observation with a point and map species to the colour of each point
      labs(title = "Bill Depth and Length", #change labels and titles  #everything related to a title you can change in lab function
           subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
           x = "Bill Depth (mm)", y = "Bill Length (mm)") 
           
```

### Aesthetic Options. 
* if directly related to data set, it goes in aesthetics
* color, shape, size, alpha (transparency)
* change everythihng related to title in labs function
```{r}
ggplot(data=penguins,
       mapping = aes(x = bill_depth_mm,  
                     y = bill_length_mm, 
                     color = species)) + #change in aesthetic
      geom_point() +
      labs(title = "Bill Depth and Length", 
           subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
           x = "Bill Depth (mm)", y = "Bill Length (mm)", 
           color = "Species",  #label the legend
           caption = "Source: Palmer Station LTER / palmerpenguins package") + #add caption for source of data
  scale_color_viridis_d() #discrete color scale palette better for colorblind
```

```{r}
ggplot(data=penguins,
       mapping = aes(x = bill_depth_mm,  
                     y = bill_length_mm, 
                     color = species)) + #change in aesthetic
      geom_point()                    
```
** need to finish editing
```{r}

```

      labs(title = "Bill Depth and Length", #change labels and titles  #everything related to a title you can change in lab function
           subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
           x = "Bill Depth (mm)", y = "Bill Length (mm)", 
           color = "Species",  #label the legend
           caption = "Source: Palmer Station LTER / palmerpenguins package") + #add caption for source of data
  scale_color_viridis_d() #discrete color scale palette better for colorblind
#check: if you press enter, lines should line up with each other if done correctly



#Shape, Size, Alpha
ggplot(data=penguins,
       mapping = aes(x = bill_depth_mm,
                     y = bill_length_mm,
                     color = species,
                     shape = island, #mapped to a different variable than color (can also map to same variable as color)
                     size = body_mass, #adding size to points
                     alpha = flipper_len)) + #good for adding p-values to make it pop #adding a shape legend
  geom_point() +
  labs(title = "Bill Depth and Length", 
       subtitle = "Dimensions for Adelie, Chinstrap, and Gentoo Penguins",
       x = "Bill Depth (mm)", y = "Bill Length (mm)", 
       color = "Species",
       shape = "Island", #capitalizing the title of legend
       size = "Body Mass (g)",
       alpha = "Flipper Length (mm)",
       caption = "Source: Palmer Station LTER / palmerpenguins package") +
  scale_color_viridis_d()


#Mapping vs Setting
#Mapping: Determine the size, shape, alpha, etc. of points **based on the values of a variable** in the data goes into
#Setting: Determine the size, shape, alpha, etc. of points **not** based on the values of a variable in the data goes into .orange[geom_*()]. 
#This was geom_point() in the previous example, but we will learn more geoms soon.   
                     
#Mapping
ggplot(data=penguins, 
       mapping = aes(x = bill_depth_mm,
                     y = bill_length_mm,
                     size = body_mass_g, 
                     alpha = flipper_length_mm)) +
  geom_point()

#setting
ggplot(data=penguins, 
       mapping = aes(x = bill_depth_mm,
                     y = bill_length_mm)) +
  geom_point(size = 2, alpha = 0.5)


#Faceting
#automatically adds labels                 
#Smaller plots that display different subsets of the data
#Useful for exploring conditional relationships and large data

#Note: Did not put proper titles, axis labels, etc. because I am focusing on faceting.
#However, remember to always label your plots!

ggplot(penguins, 
       aes(x = bill_depth_mm,
           y = bill_length_mm))+
  geom_point()+
  facet_grid(species~sex) #grid will always be perfectly grided, cant control how many rows and columns
# make multiple plots groups by species on the y (rows) and and sex on the x (columns) 

#Notice there is a section labeled **NA** for sex. This is because there were some birds where they did not know the sex.  
#We will learn how to clean this up next week.

ggplot(penguins, 
       aes(x = bill_depth_mm,
           y = bill_length_mm))+
  geom_point()+
  facet_grid(sex~species) #
# make multiple plots groups by sex on the y (rows) and and species on the x (columns) 


ggplot(penguins, aes(x = bill_dep, y = bill_len)) + 
  geom_point() +
  facet_wrap(~ species) #describe exactly how many rows and columns you want, wraps it down

ggplot(penguins, aes(x = bill_dep, y = bill_len)) + 
  geom_point() +
  facet_wrap(~ species, ncol=2) # make it two columns 

# Faceting summary
#facet_grid():
  #2D grid
  #rows ~ columns

#facet_wrap(): 
#1d ribbon wrapped according to numbers of rows and columns specified or available plotting area

# Facet and color
#multiple ways to visualize data
    ggplot(data=penguins, 
           mapping = aes(x = bill_dep,
                         y = bill_len,
                         color = species)) +
      geom_point()+
      scale_color_viridis_d()+
      facet_grid(species~sex)

#Facet and color, no legend
    ggplot(data=penguins, 
           mapping = aes(x = bill_dep,
                         y = bill_len,
                         color = species, #<<
           )) +
      geom_point()+
      scale_color_viridis_d()+
      facet_grid(species~sex)+
      guides(color = FALSE) #delete specifically
    
# ggplot2 resources
    
# [Data to viz](https://www.data-to-viz.com/#histogram)  
# [ggplot2 cheatsheet](https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf)  
# [All the geoms](https://ggplot2.tidyverse.org/reference/)  
# [A master list of visuals](http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html)   
# [Practical ggplot](https://wilkelab.org/practicalgg/)   
# [R graph gallery](https://www.r-graph-gallery.com/)
    
###########################################
#Plotting 2 (2nd Lecture)
    
#Make a simple plot
#Data analyisis section
ggplot(data = penguins, 
       mapping = aes(x = bill_depth_mm,   #bill depth
                     y = bill_length_mm,
                     group = species, #plot relationship by species (group by whatever variable we give it)
                     color = species) #add colors by species
       ) + 
      geom_point() +
      geom_smooth(method = "lm") + #adds new data set/method, "lm" adds linear model, can also add standard error (se = FALSE)
      labs(x = "Bill Depth (mm)",
           y = "Bill Length (mm)") +
      scale_color_viridis_d() #chnage color scale
    
    
    
    
    
    
    
    
    