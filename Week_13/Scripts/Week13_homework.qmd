---
title: "Week 13 Homework"
author: "Haley Poppinga"
format: 
  html: 
    toc: true
    theme: sandstone
---

### Introduction  

**Homework**  
You have a set of 4 .csv files in data/homework. Each of these files is a timeseries of temperature and light data collected in tide pools in Oregon by Jenn Fields. Your goal is to bring in all 4 files and calculate the mean and standard deviation of both temperature (Temp.C) and light (Intensity.lux) for each tide pool. Use both a for loop and map() functions in your script. (Basically, do it twice). Due Tuesday at 1pm.    



### Load Libraries  
```{r}
#| warning: false
#| message: false

library(tidyverse)
library(here) 
```


### For Loops  

**for loop** method for multiple data files where you want to perform the same action to each.  


#### Read the Data  
```{r}
#| warning: false
#| message: false

TP_homework<-read_csv(here("Week_13", "Data", "homework","TP1.csv")) 
glimpse(TP_homework)
# point to the location on the computer of the folder
Week13Path<-here("Week_13", "Data", "homework") # check this in console
# list all the files in that path with a specific pattern
# In this case we are looking for everything that has a .csv in the filename
# you can use regex to be more specific if you are looking for certain patterns in filenames
TPfiles <- dir(path = Week13Path, pattern = ".csv")
TPfiles
```

#### Make the Loop  
Calculate the mean and standard deviation of both temperature (Temp.C) and light (Intensity.lux) for each tide pool.  

**Pre-allocate space**  
```{r}
#| warning: false
#| message: false

# pre-allocate space
# make an empty dataframe that has one row for each file and 3 columns
TP_data<-tibble(filename =  rep(NA, length(TPfiles)),  # column name
                mean_Temp = rep(NA, length(TPfiles)), # column name for the mean temperature
                sd_Temp = rep(NA, length(TPfiles)),
                mean_Light = rep(NA, length(TPfiles)), # column name for the mean light
                sd_Light = rep(NA, length(TPfiles))) # column name for the sd
TP_data
```

**Turn it into a for loop**  
**Add in the loop over the raw data**  
**Calculate mean and sd**  
```{r}
#| warning: false
#| message: false

for (i in 1:length(TPfiles)){ # loop over 1:3 the number of files
  TP_raw_data<-read_csv(paste0(Week13Path,"/", TPfiles[i])) # add in loop over raw data
  TP_data$filename[i]<-TPfiles[i] # add in columns (filename for each row)
  TP_data$mean_Temp[i]<-mean(TP_raw_data$Temp.C, na.rm = TRUE) # add in means
  TP_data$sd_Temp[i]<-sd(TP_raw_data$Temp.C, na.rm = TRUE) # add in sd
  TP_data$mean_Light[i]<-mean(TP_raw_data$Intensity.lux, na.rm = TRUE)
  TP_data$sd_Light[i]<-sd(TP_raw_data$Intensity.lux, na.rm = TRUE)
}
TP_data
```

### Map()   

#### Read in Data  
**Reminder: Find the files**  
```{r}
#| warning: false
#| message: false

# point to the location on the computer of the folder
week13path<-here("Week_13", "Data", "homework")
tpfiles <- dir(path = week13path, pattern = ".csv", full.names = TRUE)
tpfiles
```




#### Make a Loop  
**Use maps and purrr**  
**Read in the files**  
**Calculate means and sd**  
```{r}
#| warning: false
#| message: false

tp_homework<-tpfiles %>%
  set_names(basename(.)) %>% # set's the base csv id of each list to the file name
  map_df(~ read_csv(.x, show_col_types = FALSE), .id = "filename") # map everything to a dataframe and put the id in a column called filename

tp_data<-tp_homework %>% 
  group_by(filename) %>%
  summarise(mean_temp = mean(Temp.C, na.rm = TRUE),
            sd_temp = sd(Temp.C, na.rm = TRUE),
            mean_light = mean(Intensity.lux,na.rm = TRUE),
            sd_light = sd(Intensity.lux, na.rm = TRUE))
tp_data
```





##### Extra  
```{r}
# write_csv(TP_data, here("Week_13","Output","TP_loops_homework.csv")) # export csv file
# write_csv(tp_data, here("Week_13","Output","tp_maploop_homework.csv"))

# To do before running code:
# Empty your environment before you start working
# Restart R
# .rs.restartR()
# remove whole list in environment
# rm(list = ls())
```


#### Map Functions  

map() makes a list.  
map_lgl() makes a logical vector.  
map_int() makes an integer vector.  
map_dbl() makes a double vector.  
map_chr() makes a character vector.  
map_df() makes a dataframe.  


Data Dictionary  

Variable Name	          Description  
PoolID	                ID of the pool  
Foundation_spp	        Surfgrass or mussel dominated pool  
Removal_Control	        Was it a removal or control treatment  
Date.Time	              Date and time  
Temp.C	                Temperature in degrees C  
Intensity.lux	          Light level in lux  
LoggerDepth	            Depth of the logger in meters  













